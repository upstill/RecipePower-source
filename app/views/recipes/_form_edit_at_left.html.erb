<%= content_tag(:div,
                class: "dialog edit_recipe modal at_left hide",
                style: "overflow:visible",
                data: (defined?(@data) ? @data : {})) do %>
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <% unless recipe %>
              <input class="close cancel" data-dismiss="modal" name="commit" type="submit" value="x"/>
          <% end %>
          <h3>Tag That Recipe!</h3>
        </div>
        <form accept-charset="UTF-8" action="/recipes/<%= present_field "rcpID" %>" class="form-inline edit_recipe" data-remote="true" data-type="json" id="edit_recipe_<%= present_field "rcpID" %>">
          <input name="utf8" type="hidden" value="&#x2713;"/>
          <input name="_method" type="hidden" value="post"/>
          <input name="authenticity_token" type="hidden" value="<%= present_field "authToken" %>"/>

          <div class="modal-body" style="overflow:visible">
            <div class="notifications-panel">
            </div>
            <div class="row">
              <div class="col-md-5">
                <div class="edit_recipe_field pic">
                  <%= pic_preview_widget present_field("rcpURL"), present_field("rcpPicSafeURL"), present_field("rcpID") %>
                  <div class="pic_preview">
                    <img alt="Some Image Available" id="rcpPic<%= present_field "rcpID" %>" src="<%= present_field "rcpPicSafeURL" %>" style="width:100%; height: auto"/>
                    <input type="hidden" id="recipe_picurl" name="recipe[picurl]" rel="jpg,png,gif" size="30" type="text" value="<%= present_field "rcpPicURL" %>"/>
                  </div>
                  <div class="pic_picker_link">
                    <%= link_to_preload "Pick Picture", %Q{/recipes/#{present_field "rcpID"}/edit?pic_picker=true}, class: "hide pic_picker_golink", data: { vals: "recipe_picurl;div.pic_preview img" }  %>
                  </div>
                </div>
              </div>
              <div class="col-md-7">
                <div class="control-group">
                  <textarea id="recipe_title" name="recipe[title]" placeholder="Title" style="width:100%"><%= present_field "rcpTitle" %></textarea>
                </div>
                <div class="control-group">
                  <input type="text"
                         class="token-input-field-pending"
                         id="recipe_collection_tokens"
                         name="recipe[collection_tokens]"
                         rows="2"
                         size="30"
                         placeholder="In My Collections"
                         data-pre="<%= @recipe ? @recipe.collections.map(&:attributes).to_json : "" %>"/>
                </div>
                <div class="control-group">
                  <input type="text"
                         class="token-input-field-pending"
                         id="recipe_channel_tokens"
                         name="recipe[channel_tokens]"
                         rows="2"
                         size="30"
                         placeholder="Channels"
                         data-pre="<%= @recipe ? @recipe.channels.map(&:attributes).to_json : "" %>"/>
                </div>
                <div class="control-group">
                  <input type="text"
                         class="token-input-field-pending"
                         id="recipe_misc_tag_tokens"
                         name="recipe[misc_tag_tokens]"
                         rows="2"
                         size="30"
                         placeholder="Tags"
                         data-pre="<%= @recipe ? @recipe.misc_tags.map(&:attributes).to_json : "" %>"/>
                </div>
                <div class="control-group">
                  <textarea id="recipe_comment" name="recipe[comment]" placeholder="Recipe Notes" rows="3" style="width:100%"><%= present_field "rcpComment" %></textarea>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <input class="btn pull-left" type="submit" data-action="/recipes/<%= present_field "rcpID" %>/remove" value="Remove" data-method="post"/>
            <% if permitted_to? :admin, :pages %>
                <input class="btn btn-danger pull-left" type="submit" data-action="/recipes/<%= present_field "rcpID" %>" data-method="delete" value="Destroy" data-confirm="This will remove the recipe from RecipePower and EVERY collection in which it appears. Are you sure this is appropriate?"/>
            <% end %>
            <input name="recipe[private]" type="hidden" value="0"/>
            <label for="recipe_private" class="checkbox">
              <input <%= present_field "rcpPrivate" %> id="recipe_private" name="recipe[private]" type="checkbox" value="1"/>Private
              cookmark
            </label>
            <input class="cancel btn" data-dismiss="modal" name="commit" type="submit" value="Cancel"/>
            <input class="submit btn btn-primary" name="commit" type="submit" value="Save" data-method="put"/>
          </div>
        </form>
      </div>
    </div>
<% end %>
