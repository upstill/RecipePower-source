<% viewparams = @viewparams || (@filtered_presenter && @filtered_presenter.viewparams) unless defined?(viewparams) && viewparams %>
<%= triggered_form search_path do %>
    <% if @filtered_header && viewparams.filter_type_selector %>
        <%= select_tag :tagtype, options_from_collection_for_select(Tag.type_selections(withnull: true, withall: true), :last, :first, viewparams.tagtype),
                       :include_blank => false,
                       :onchange => 'RP.submit.onselect( event );' %>
    <% end %>
    <div class="token-input-holder">
      <%= token_input_query(
                  :querytags => (viewparams ? viewparams.querytags : []),
                  :hint => '', # 'Type food terms and hit Enter or Return',
                  :glyphicon => (defined?(glyphicon) && glyphicon),
                  :autofocus => false,
                  :class => 'token-input-text-input',
                  :placeholder => 'Let\'s cook up something...') %>
    </div>
<% end %>
